from Crypto.Util.number import bytes_to_long, getPrime, isPrime, inverse, long_to_bytes
from Crypto.PublicKey import RSA
import sys
sys.path.append('../../rsa_textbook_attacks')
from basic_rsa import decrypt
# from secret import flag

def next_prime(p):
    while True:
        p = p+1
        if isPrime(p):
            return p

# p = getPrime(512)
# q = next_prime(p)

p = 9196705130308909169105636708324483461176018336231342158497033528430092427027363603702631273464155871304330602316967980393438012303034650953366081852782033
q = 9196705130308909169105636708324483461176018336231342158497033528430092427027363603702631273464155871304330602316967980393438012303034650953366081852782561
n = p*q
assert n == 84579385253850209980531118129485716360575269582423585759001305965013034395499445816183248675447710453177558996114910965695049824431833160231360553529286419317374940825879760576417322050461035628520331998356731488662783964882867470865445762024182798458285340930223702904421982112483822508094601373760076526513
e = 65537
phi = (p-1)*(q-1)
d = inverse(e, phi)

key = RSA.construct((n, e, d))

# print(n)
# m = bytes_to_long(flag)
# print(pow(m,e,n))

c = 17668912838657324025145974741772418705042500725249546941532860274474967308105880488339989276944955996505219230783445824255159192918050910923274393622976856688164873271519593664637389313627158186713709798641755794557335453137110328826176249263923330675599181311888750799280794535134718146446678320514719996743

print(long_to_bytes(decrypt(c, key)))

#84579385253850209980531118129485716360575269582423585759001305965013034395499445816183248675447710453177558996114910965695049824431833160231360553529286419317374940825879760576417322050461035628520331998356731488662783964882867470865445762024182798458285340930223702904421982112483822508094601373760076526513
#17668912838657324025145974741772418705042500725249546941532860274474967308105880488339989276944955996505219230783445824255159192918050910923274393622976856688164873271519593664637389313627158186713709798641755794557335453137110328826176249263923330675599181311888750799280794535134718146446678320514719996743